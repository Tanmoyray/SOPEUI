<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project id="8f403e80-6550-4827-9d29-8ac017a76d52" activeEnvironment="Default" name="SearchWeatherDataProp&amp;Excel" resourceRoot="${projectDir}" soapui-version="5.4.0" abortOnError="false" runType="SEQUENTIAL" xmlns:con="http://eviware.com/soapui/config"><con:settings/><con:interface xsi:type="con:RestService" id="32e7293e-11a2-4fa7-a993-c39486e57a5e" wadlVersion="http://wadl.dev.java.net/2009/02" name="SearchWeatherDataByLocation" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart=""/><con:endpoints><con:endpoint>https://community-open-weather-map.p.rapidapi.com</con:endpoint></con:endpoints><con:resource name="GetData" path="/find" id="11455293-28a0-407d-876a-5fdb1823462e"><con:settings/><con:parameters><con:parameter><con:name>q</con:name><con:value/><con:style>QUERY</con:style><con:default/><con:description xsi:nil="true"/></con:parameter></con:parameters><con:method name="GetWeatherData" id="ed49a45a-a157-40a3-9152-561235e2dccf" method="GET"><con:settings/><con:parameters/><con:representation type="FAULT"><con:mediaType>application/json</con:mediaType><con:status>401 404</con:status><con:params/><con:element xmlns:com="https://community-open-weather-map.p.rapidapi.com/community-open-weather-map.p.rapidapi.com">com:Fault</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json; charset=utf-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:com="https://community-open-weather-map.p.rapidapi.com/community-open-weather-map.p.rapidapi.com">com:Response</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:request name="GetDataByLocationName" id="2c2772e3-7974-40ea-ac7d-626c52d76f3a" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment xmlns:con="http://eviware.com/soapui/config">
  &lt;con:entry key="X-RapidAPI-Host" value="community-open-weather-map.p.rapidapi.com"/>
  &lt;con:entry key="X-RapidAPI-Key" value="95863630c5msh06f41e0848be7cap16ffa0jsna7beb6ab63f2"/>
&lt;/xml-fragment></con:setting></con:settings><con:endpoint>https://community-open-weather-map.p.rapidapi.com</con:endpoint><con:request/><con:originalUri>https://community-open-weather-map.p.rapidapi.com/community-open-weather-map.p.rapidapi.com</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="q" value="london" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>q</con:entry></con:parameterOrder></con:request></con:method></con:resource></con:interface><con:testSuite id="d2717aeb-eba9-4c8d-8ba7-136be42866d1" name="Testing_SearchWeatherDataByLocation"><con:description>TestSuite generated for REST Service [SearchWeatherDataByLocation]</con:description><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="c6f1e37f-4cb1-4165-97d9-e0838cf2feb9" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="GetDataTC" searchProperties="true"><con:description>TestCase generated for REST Resource [GetData] located at [/find]</con:description><con:settings/><con:testStep type="properties" name="RequestDriver" id="2bee2dcf-9640-4493-8ee2-4c89dc291144"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>Env</con:name><con:value>DEV_Env</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="properties" name="DEV_Env" id="31814ef9-9016-4854-9ae3-9bd2f1724067"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>Env</con:name><con:value>https://community-open-weather-map.p.rapidapi.com</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="properties" name="Staging_Env" id="7a876fd5-ef36-4065-ae04-ab73ae3e072c"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>Env</con:name><con:value>https://Staging-community-open-weather-map.p.rapidapi.com</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="properties" name="Prod_Env" id="ccc066b6-d4a6-464b-968a-41d645cbf505"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>Env</con:name><con:value>https://test_prod-community-open-weather-map.p.rapidapi.com</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="restrequest" name="GetDataByLocationName" id="af231ede-fd5b-4b8d-aea7-382baa3b34dc"><con:settings/><con:config service="SearchWeatherDataByLocation" resourcePath="/find" methodName="GetWeatherData" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetDataByLocationName" id="2c2772e3-7974-40ea-ac7d-626c52d76f3a" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment xmlns:con="http://eviware.com/soapui/config">
  &lt;con:entry key="X-RapidAPI-Host" value="community-open-weather-map.p.rapidapi.com"/>
  &lt;con:entry key="X-RapidAPI-Key" value="95863630c5msh06f41e0848be7cap16ffa0jsna7beb6ab63f2"/>
&lt;/xml-fragment></con:setting></con:settings><con:endpoint>${#TestCase#endpoint}</con:endpoint><con:request/><con:originalUri>https://community-open-weather-map.p.rapidapi.com/community-open-weather-map.p.rapidapi.com</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="a463719f-828d-4fb4-a36c-934962975280" name="CheckWith_StatusCode"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:assertion type="JsonPath Match" id="21ae2a3f-6172-4a42-9b1c-09ec97ba6082" name="LocationChcek"><con:configuration><path>list[0].name</path><content>${#TestCase#location}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Response SLA Assertion" id="1406fb91-67ea-4c59-a3d9-3660947271bf" name="Response Time"><con:configuration><SLA>5000</SLA></con:configuration></con:assertion><con:assertion type="GroovyScriptAssertion" id="1af75166-846a-4ea3-ae88-704a4418796f" name="GetAllParameter"><con:configuration><scriptText>import groovy.json.JsonSlurper
def getResponce= messageExchange.response.responseContent

def jsonl= new JsonSlurper().parseText(getResponce)
def allParameter= jsonl.list[0].main
log.info allParameter</scriptText></con:configuration></con:assertion><con:assertion type="JsonPath Match" id="be56ee03-86e4-46a7-ac82-6273025dafbb" name="JsonPath Match" disabled="true"><con:configuration><path>list[0].main.*</path><content>${#TestCase#temp}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="q" value="${#TestCase#location}" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>q</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="ReadDataFromExcel&amp;ReadDataFromDriverandSendThroughPropertyFiles" id="f2f82276-175a-4c18-9412-1a52329a5a1d"><con:settings/><con:config><script>import jxl.*
import jxl.write.*
import com.eviware.soapui.impl.wsdl.testcase.WsdlTestRunContext
import groovy.json.JsonSlurper

def env_prop=testRunner.testCase.testSteps['RequestDriver'].getPropertyValue('Env')
def EnvironmentSet=testRunner.testCase.testSteps[env_prop].getPropertyValue('Env')

log.info EnvironmentSet
testRunner.testCase.setPropertyValue('endpoint',EnvironmentSet)

projectPath = context.expand( '${projectDir}')
Workbook workbook = Workbook.getWorkbook(new File(projectPath+"\\WeatherInputDataSheet.xls"))
Sheet sheet = workbook.getSheet(0)
def rowCount = sheet.getRows()
def colCount = sheet.getColumns()
for (i=1; i&lt;rowCount; i++){
	for(j=0;j&lt;colCount;j++) { 
       Cell cell = sheet.getCell(j,i) 
      def getLocFromExcel =  cell.getContents() 
	 //log.info getLocFromExcel


//Set Location in TestCase property
       def TC_SetLocationProp =testRunner.testCase.setPropertyValue('location',getLocFromExcel)
	  //log.info SetLoc

//Response Data Validate
//	def getResData=testRunner.testCase.testSteps['GetDataByLocationName'].getPropertyValue("Response")
//	log.info getResData
//	def jsonl= new JsonSlurper().parseText(getResData)
//	def tempParameter= jsonl.list[0].main.temp
//	log.info tempParameter
//	def settemp=testRunner.testCase.setPropertyValue('temp',tempParameter)

//Run GetDataByLocationName Request
	  def getLocName=testRunner.testCase.testSteps['GetDataByLocationName']
	  def addstepcontext=new WsdlTestRunContext(getLocName)
       getLocName.run(testRunner,addstepcontext)

	}
}</script></con:config></con:testStep><con:properties><con:property><con:name>location</con:name><con:value>Kolkata</con:value></con:property><con:property><con:name>temp</con:name><con:value/></con:property><con:property><con:name>endpoint</con:name><con:value>https://community-open-weather-map.p.rapidapi.com</con:value></con:property></con:properties></con:testCase><con:properties/></con:testSuite><con:properties/><con:wssContainer/><con:oAuth2ProfileContainer/><con:oAuth1ProfileContainer/><con:sensitiveInformation/></con:soapui-project>